---
const { version, label, date, summary } = Astro.props;
---

<section class="py-[var(--_typography-size---gap--section-gap)] text-white">
  <div class="main-container">
    <div class="flex justify-center">
      <div
        class="relative w-full max-w-[550px] rounded-[16px] bg-gradient-to-r from-[#d8ae6b] to-[#1ad079] px-[70px] py-[40px] shadow-[0_6px_16px_#01010166] max-[479px]:px-[40px] max-[479px]:max-w-full"
        data-changelog-animate
      >
        <div class="absolute inset-0 z-[1] m-[1px] rounded-[16px] bg-black">
        </div>
        <div class="relative z-10">
          <div
            class="text-center text-[28px] font-semibold leading-[1.5] text-white"
          >
            {version}
          </div>
          <div
            class="mt-5 mb-5 flex items-center justify-center gap-5 max-[479px]:flex-col min-[1920px]:mb-[15px]"
          >
            <div
              class="rounded-[5px] bg-white px-[10px] py-[10px] text-[16px] font-medium leading-[1.5] text-[#070707] min-[1920px]:text-[18px]"
            >
              {label}
            </div>
            <div
              class="text-[16px] font-medium leading-[1.5] text-white min-[1920px]:text-[18px]"
            >
              {date}
            </div>
          </div>
          <p
            class="text-center text-[16px] leading-[1.5] text-white min-[1920px]:text-[18px]"
          >
            {summary}
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  [data-changelog-animate] {
    opacity: 0;
    filter: blur(80px);
    transform: translateY(35px) scale(0.98);
    transition:
      opacity 0.8s ease,
      filter 0.8s ease,
      transform 0.8s ease;
  }

  [data-changelog-animate].animate-in {
    opacity: 1;
    filter: blur(0);
    transform: translateY(0) scale(1);
  }
</style>

<script>
  const initChangelogAnimation = () => {
    const animatedElements = document.querySelectorAll(
      "[data-changelog-animate]",
    );

    if (!animatedElements.length) return;

    const observer = new IntersectionObserver(
      (entries: IntersectionObserverEntry[]) => {
        entries.forEach((entry: IntersectionObserverEntry) => {
          if (entry.isIntersecting) {
            const el = entry.target as HTMLElement;
            el.classList.add("animate-in");
            observer.unobserve(el);
          }
        });
      },
      {
        threshold: 0.2,
        rootMargin: "0px 0px -40px 0px",
      },
    );

    animatedElements.forEach((el) => observer.observe(el));
  };

  document.addEventListener("DOMContentLoaded", initChangelogAnimation);
  document.addEventListener("astro:page-load", initChangelogAnimation);
</script>
