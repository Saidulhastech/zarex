---
import Button from "../ui/Button.astro";
import AppImage from "../ui/AppImage.astro";
---

<section
  class="relative flex h-screen w-screen max-h-full max-w-full items-center justify-center overflow-hidden bg-[url('/src/assets/images/404.png')] bg-cover bg-center max-[767px]:px-[15px]"
>
  <div
    class="absolute inset-0 z-[1] flex items-start justify-center"
    data-not-found-animate
    data-not-found-delay="0.05"
  >
    <AppImage
      src="/images/404-single-bg-image.png"
      alt=""
      width="1631"
      height="1000"
      class="w-full max-w-[1631px]"
      loading="eager"
      fetchpriority="high"
      aria-hidden="true"
    />
  </div>

  <div class="relative z-10 flex flex-col items-center text-center">
    <div
      class="flex items-center justify-center gap-2 min-[1440px]:items-start"
      data-not-found-animate
      data-not-found-delay="0.1"
    >
      <h1
        class="bg-gradient-to-r from-[#d8ae6b] to-[#1ad079] bg-clip-text text-[260px] font-bold leading-[0.8] text-transparent max-[991px]:text-[220px] max-[767px]:text-[180px] max-[479px]:text-[120px] min-[1440px]:text-[320px]"
      >
        4
      </h1>
      <AppImage
        src="/images/404-images.png"
        alt="Animated characters representing the zero in 404"
        width="230"
        height="230"
        class="w-[230px] max-[767px]:w-[180px] max-[479px]:w-[100px]"
        loading="eager"
        fetchpriority="high"
      />
      <h1
        class="bg-gradient-to-r from-[#d8ae6b] to-[#1ad079] bg-clip-text text-[260px] font-bold leading-[0.8] text-transparent max-[991px]:text-[220px] max-[767px]:text-[180px] max-[479px]:text-[120px] min-[1440px]:text-[320px]"
      >
        4
      </h1>
    </div>

    <div
      class="mt-5 min-[1440px]:mt-6"
      data-not-found-animate
      data-not-found-delay="0.2"
    >
      <h2
        class="font-title text-[length:var(--_typography-size---typography--h2)] font-normal leading-[1.2] tracking-[-0.02em] text-white"
      >
        Page Not Found
      </h2>
    </div>

    <div
      class="mt-[var(--_typography-size---gap--subtitle-gap)] max-w-[450px]"
      data-not-found-animate
      data-not-found-delay="0.3"
    >
      <p class="text-[18px] leading-[1.6] text-[#c4c4c4]">
        Please return to the site's homepage, It looks like nothing was found at
        this location
      </p>
    </div>

    <div
      class="mt-[30px] min-[1440px]:mt-10 max-[767px]:mt-6"
      data-not-found-animate
      data-not-found-delay="0.4"
    >
      <Button href="/">Back to home</Button>
    </div>
  </div>
</section>

<style>
  [data-not-found-animate] {
    opacity: 0;
    transform: translateY(24px) scale(0.98);
    filter: blur(14px);
    transition:
      opacity 0.6s ease,
      transform 0.6s ease,
      filter 0.6s ease;
  }

  [data-not-found-animate].animate-in {
    opacity: 1;
    transform: translateY(0) scale(1);
    filter: blur(0);
  }
</style>

<script>
  const initNotFoundAnimation = () => {
    const animatedElements = document.querySelectorAll(
      "[data-not-found-animate]",
    );

    if (!animatedElements.length) return;

    const prefersReducedMotion = window.matchMedia(
      "(prefers-reduced-motion: reduce)",
    ).matches;

    if (prefersReducedMotion) {
      animatedElements.forEach((element) => {
        element.classList.add("animate-in");
      });
      return;
    }

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (!entry.isIntersecting) return;
          const el = entry.target as HTMLElement;
          const delay = parseFloat(el.dataset.notFoundDelay || "0");

          setTimeout(() => {
            el.classList.add("animate-in");
          }, delay * 1000);

          observer.unobserve(el);
        });
      },
      {
        threshold: 0.2,
        rootMargin: "0px 0px -60px 0px",
      },
    );

    animatedElements.forEach((el) => observer.observe(el));
  };

  document.addEventListener("DOMContentLoaded", initNotFoundAnimation);
  document.addEventListener("astro:page-load", initNotFoundAnimation);
</script>

