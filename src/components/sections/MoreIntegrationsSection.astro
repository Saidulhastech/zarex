---
import Container from "../ui/Container.astro";
import Button from "../ui/Button.astro";
import AppImage from "../ui/AppImage.astro";

type IntegrationItem = {
  href: string;
  icon: string;
  status: string;
  title: string;
  summary: string;
};

const { items } = Astro.props as { items: IntegrationItem[] };
---

<section class="py-[var(--_typography-size---gap--section-gap)] text-white">
  <Container>
    <div
      class="flex flex-col items-center text-center"
      data-more-integrations-animate
      data-more-integrations-delay="0.05"
    >
      <div class="max-w-[500px]">
        <h2 class="font-title text-[length:var(--_typography-size---typography--h2)] font-normal leading-[1.2] tracking-[-0.02em] text-white">
          More <span class="highlight-text">Integrations</span> for Your Growth Stack
        </h2>
      </div>
      <div class="mt-[var(--_typography-size---gap--subtitle-gap)] max-w-[528px]">
        <p class="text-[18px] text-[#c4c4c4]">
          Ensures that you&#x27;re reaching out to new potential customers <br />every day regardless of how busy your schedule is.
        </p>
      </div>
    </div>

    <div class="mt-[var(--_typography-size---gap--content-gap)] grid grid-cols-3 gap-x-5 gap-y-[30px] min-[1440px]:gap-x-[30px] min-[1440px]:gap-y-[40px] max-[991px]:grid-cols-2 max-[767px]:grid-cols-1">
      {items.map((item, index) => (
        <article
          class="rounded-[var(--_typography-size---gap--border-radius)] border border-white/10 bg-[#0e1522] px-[24px] py-[30px] min-[1440px]:px-[32px] min-[1440px]:py-[40px] max-[767px]:p-5"
          data-more-integrations-animate
          data-more-integrations-delay={(0.1 + index * 0.06).toFixed(2)}
        >
          <div class="flex items-center justify-between gap-4">
            <a href={item.href} class="flex items-center justify-center">
              <div class="relative z-[12] flex h-[80px] w-[80px] min-h-[80px] min-w-[80px] flex-none items-center justify-center rounded-full border border-white/10 bg-[linear-gradient(27deg,#0e1522,#1a2d52)] [transform-origin:50%] min-[1440px]:h-[105px] min-[1440px]:w-[105px] min-[1440px]:min-h-[105px] min-[1440px]:min-w-[105px] max-[767px]:h-[70px] max-[767px]:w-[70px] max-[767px]:min-h-[70px] max-[767px]:min-w-[70px] max-[479px]:h-[50px] max-[479px]:w-[50px] max-[479px]:min-h-[50px] max-[479px]:min-w-[50px]">
                <AppImage
                  src={item.icon}
                  alt="Integration Icon"
                  width="50"
                  height="50"
                  class="w-[50px] min-[1280px]:w-auto max-[991px]:w-[40px]"
                  loading="lazy"
                />
              </div>
            </a>
            <div class="text-[18px] font-medium leading-none text-[#c4c4c4]">{item.status}</div>
          </div>
          <a href={item.href} class="mt-5 block text-white transition hover:text-[#d8ae6b] min-[1280px]:mt-7">
            <h4 class="font-title text-[length:var(--_typography-size---typography--h4)] font-medium leading-[1.4] tracking-[-0.01em]">
              {item.title}
            </h4>
          </a>
          <p class="mt-4 text-[16px] text-[#c4c4c4] min-[1440px]:mt-5">
            {item.summary}
          </p>
          <div class="my-[14px] h-px w-full bg-[#2f2e2e] min-[1440px]:my-5"></div>
          <div class="flex items-center justify-between gap-4">
            <div class="flex items-center gap-2">
              <AppImage
                src="/images/006-settings.svg"
                alt="Configure Icon"
                width="20"
                height="20"
                class="h-5 w-5"
                loading="lazy"
              />
              <span class="text-[14px] leading-none text-[#c4c4c4]">Configure</span>
            </div>
            <label class="flex h-[18px] w-[36px] cursor-pointer items-center rounded-full border border-white/10 bg-[#313131] p-[3px] transition-colors">
              <input type="checkbox" class="peer sr-only" />
              <span class="h-3 w-3 rounded-full bg-[#6356e0] transition-transform duration-200 peer-checked:translate-x-[18px]"></span>
            </label>
          </div>
        </article>
      ))}
    </div>

    <div
      class="mt-10 flex flex-wrap items-center justify-center gap-4"
      data-more-integrations-animate
      data-more-integrations-delay="0.15"
    >
      <Button href="/integration">All Integrations</Button>
      <Button href="/contact-us" variant="outline">Start free trial</Button>
    </div>
  </Container>
</section>

<style>
  [data-more-integrations-animate] {
    opacity: 0;
    transform: translateY(24px);
    transition:
      opacity 0.6s ease,
      transform 0.6s ease;
  }

  [data-more-integrations-animate].animate-in {
    opacity: 1;
    transform: translateY(0);
  }
</style>

<script>
  function initMoreIntegrationsAnimations() {
    const animatedElements = document.querySelectorAll(
      "[data-more-integrations-animate]",
    );

    if (!animatedElements.length) return;

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (!entry.isIntersecting) return;
          const el = entry.target;
          if (!(el instanceof HTMLElement)) return;
          const delay = parseFloat(el.dataset.moreIntegrationsDelay || "0");

          setTimeout(() => {
            el.classList.add("animate-in");
          }, delay * 1000);

          observer.unobserve(el);
        });
      },
      {
        threshold: 0.15,
        rootMargin: "0px 0px -60px 0px",
      },
    );

    animatedElements.forEach((el) => observer.observe(el));
  }

  document.addEventListener("DOMContentLoaded", initMoreIntegrationsAnimations);
  document.addEventListener("astro:page-load", initMoreIntegrationsAnimations);
</script>
