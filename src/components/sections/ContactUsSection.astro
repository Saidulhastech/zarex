---
import Container from "../ui/Container.astro";
import FormInput from "../ui/FormInput.astro";
import FormTextarea from "../ui/FormTextarea.astro";

const { content } = Astro.props;
const { hero, socials, infoColumns, video, form, map } = content;

const socialIcons = {
  facebook: {
    width: 11,
    height: 18,
    viewBox: "0 0 11 18",
    path: "M10.2608 10.0485L10.779 6.81553H7.53702V4.71753C7.53702 3.83304 7.9899 2.97087 9.442 2.97087H10.916V0.218447C10.916 0.218447 9.5783 0 8.29935 0C5.62921 0 3.88405 1.54835 3.88405 4.35146V6.81553H0.916016V10.0485H3.88405V17.8641C4.47921 17.9534 5.08917 18 5.71054 18C6.33191 18 6.94186 17.9534 7.53702 17.8641V10.0485H10.2608Z",
  },
  x: {
    width: 26,
    height: 25,
    viewBox: "0 0 26 25",
    path: "M23.3829 6.17128C22.6045 6.51123 21.7801 6.73412 20.9365 6.83273C21.822 6.31274 22.4879 5.48814 22.8097 4.51299C21.9707 5.00137 21.0556 5.34536 20.1026 5.5306C19.7014 5.11027 19.2186 4.7761 18.684 4.54848C18.1493 4.32085 17.5738 4.20455 16.9927 4.20666C14.6397 4.20666 12.7322 6.08614 12.7322 8.40173C12.7322 8.72986 12.7696 9.05072 12.8423 9.35704C11.1545 9.27677 9.50191 8.84554 7.99008 8.09088C6.47825 7.33621 5.14033 6.27468 4.0617 4.97403C3.68355 5.61201 3.48479 6.34031 3.48644 7.08194C3.48716 7.77555 3.66071 8.45804 3.99139 9.06774C4.32208 9.67744 4.79948 10.1951 5.38045 10.574C4.70496 10.5522 4.04407 10.3719 3.45113 10.0476V10.0995C3.45113 12.1326 4.92044 13.8283 6.86741 14.2146C6.5015 14.3117 6.12453 14.3609 5.74596 14.361C5.47079 14.361 5.20392 14.335 4.94329 14.2831C5.22166 15.1221 5.75438 15.8535 6.46745 16.3758C7.18052 16.8982 8.03855 17.1855 8.92237 17.1979C7.4064 18.3656 5.54536 18.9964 3.63181 18.9911C3.28707 18.9911 2.94856 18.9704 2.61523 18.933C4.5687 20.1694 6.83376 20.8242 9.14562 20.8208C16.9823 20.8208 21.2667 14.4275 21.2667 8.88354L21.2521 8.34046C22.0879 7.7524 22.8099 7.0174 23.3829 6.17128Z",
  },
  instagram: {
    width: 26,
    height: 25,
    viewBox: "0 0 26 25",
    path: "M13.0051 7.50641C10.2429 7.50641 8.01359 9.73568 8.01359 12.4979C8.01359 15.2602 10.2429 17.4895 13.0051 17.4895C15.7674 17.4895 17.9967 15.2602 17.9967 12.4979C17.9967 9.73568 15.7674 7.50641 13.0051 7.50641ZM13.0051 15.7421C11.2188 15.7421 9.76099 14.2843 9.76099 12.4979C9.76099 10.7116 11.2188 9.25381 13.0051 9.25381C14.7915 9.25381 16.2493 10.7116 16.2493 12.4979C16.2493 14.2843 14.7915 15.7421 13.0051 15.7421ZM18.2011 6.13866C17.5562 6.13866 17.0353 6.65947 17.0353 7.30441C17.0353 7.94934 17.5562 8.47015 18.2011 8.47015C18.846 8.47015 19.3668 7.95177 19.3668 7.30441C19.367 7.15127 19.337 6.99959 19.2785 6.85807C19.22 6.71655 19.1341 6.58796 19.0258 6.47967C18.9175 6.37138 18.789 6.28552 18.6474 6.22701C18.5059 6.16849 18.3542 6.13847 18.2011 6.13866ZM22.7351 12.4979C22.7351 11.1545 22.7473 9.8233 22.6718 8.48232C22.5964 6.92475 22.2411 5.5424 21.1021 4.40343C19.9607 3.26202 18.5808 2.90913 17.0232 2.83368C15.6798 2.75824 14.3485 2.77041 13.0076 2.77041C11.6641 2.77041 10.3329 2.75824 8.99194 2.83368C7.43436 2.90913 6.05202 3.26445 4.91304 4.40343C3.77163 5.54484 3.41874 6.92475 3.3433 8.48232C3.26785 9.82573 3.28002 11.157 3.28002 12.4979C3.28002 13.8389 3.26785 15.1726 3.3433 16.5136C3.41874 18.0711 3.77406 19.4535 4.91304 20.5925C6.05445 21.7339 7.43436 22.0868 8.99194 22.1622C10.3353 22.2376 11.6666 22.2255 13.0076 22.2255C14.351 22.2255 15.6822 22.2376 17.0232 22.1622C18.5808 22.0868 19.9631 21.7314 21.1021 20.5925C22.2435 19.451 22.5964 18.0711 22.6718 16.5136C22.7497 15.1726 22.7351 13.8413 22.7351 12.4979ZM20.5934 18.2366C20.4158 18.6796 20.2016 19.0105 19.8584 19.3513C19.5153 19.6944 19.1867 19.9086 18.7438 20.0862C17.4637 20.5949 14.424 20.4805 13.0051 20.4805C11.5863 20.4805 8.54413 20.5949 7.264 20.0887C6.82107 19.911 6.49008 19.6969 6.14936 19.3537C5.80621 19.0105 5.59204 18.682 5.41438 18.2391C4.90817 16.9565 5.02256 13.9168 5.02256 12.4979C5.02256 11.0791 4.90817 8.03695 5.41438 6.75682C5.59204 6.31389 5.80621 5.9829 6.14936 5.64218C6.49252 5.30147 6.82107 5.08487 7.264 4.9072C8.54413 4.40099 11.5863 4.51538 13.0051 4.51538C14.424 4.51538 17.4661 4.40099 18.7462 4.9072C19.1892 5.08487 19.5202 5.29903 19.8609 5.64218C20.204 5.98534 20.4182 6.31389 20.5959 6.75682C21.1021 8.03695 20.9877 11.0791 20.9877 12.4979C20.9877 13.9168 21.1021 16.9565 20.5934 18.2366Z",
  },
  whatsapp: {
    width: 29,
    height: 29,
    viewBox: "0 0 29 29",
    path: "M21.1174 7.92011C20.2597 7.05596 19.2388 6.37096 18.1139 5.90496C16.9891 5.43895 15.7828 5.20124 14.5653 5.20566C12.9376 5.20725 11.3389 5.63645 9.9293 6.4503C8.51969 7.26415 7.34865 8.43407 6.53345 9.84289C5.71825 11.2517 5.28751 12.85 5.28436 14.4777C5.28121 16.1053 5.70577 17.7053 6.51551 19.1173L5.20508 23.9261L10.1192 22.639C11.4761 23.394 13.0008 23.7963 14.5536 23.8091C17.0219 23.8091 19.3904 22.8342 21.1434 21.0965C22.8965 19.3588 23.8922 16.999 23.9138 14.5308C23.9055 13.2991 23.6543 12.0811 23.1744 10.9467C22.6946 9.81235 21.9955 8.78382 21.1174 7.92011ZM14.5653 22.2061C13.1819 22.207 11.8239 21.8352 10.634 21.1297L10.3532 20.9542L7.43983 21.7264L8.21204 18.8832L8.02484 18.5907C7.02944 16.9839 6.65795 15.0678 6.98073 13.2054C7.30352 11.343 8.29817 9.66364 9.77625 8.4855C11.2543 7.30736 13.1132 6.71225 15.0007 6.8129C16.8882 6.91356 18.6732 7.70298 20.0176 9.03164C21.4872 10.4687 22.3284 12.4288 22.3576 14.484C22.3391 16.5384 21.51 18.5025 20.0506 19.9487C18.5913 21.3949 16.6198 22.2062 14.5653 22.2061ZM18.7891 16.4262C18.5551 16.3092 17.4201 15.7476 17.2095 15.6774C16.9989 15.6072 16.8351 15.5604 16.683 15.7944C16.4541 16.1081 16.208 16.4088 15.9459 16.6953C15.8172 16.8591 15.6768 16.8708 15.4428 16.6953C14.1087 16.1681 12.9971 15.197 12.2954 13.9457C12.0497 13.5362 12.5294 13.5596 12.974 12.6821C13.0069 12.6189 13.024 12.5486 13.024 12.4774C13.024 12.4061 13.0069 12.3359 12.974 12.2726C12.974 12.1556 12.4475 11.009 12.2603 10.5527C12.0731 10.0964 11.8859 10.1666 11.7338 10.1549H11.2775C11.1593 10.1567 11.0428 10.1837 10.9359 10.2342C10.8289 10.2846 10.734 10.3573 10.6574 10.4474C10.3949 10.7026 10.1901 11.0112 10.0569 11.3523C9.92368 11.6934 9.86513 12.0591 9.88518 12.4247C9.95854 13.3 10.2882 14.1342 10.8329 14.8233C11.83 16.3159 13.1964 17.5252 14.7993 18.3333C15.6399 18.8241 16.6169 19.0293 17.5839 18.9183C17.906 18.8544 18.2109 18.7235 18.479 18.534C18.7471 18.3445 18.9724 18.1007 19.1401 17.8185C19.2955 17.4741 19.3443 17.0911 19.2805 16.7187C19.1752 16.6017 19.0231 16.5432 18.7891 16.4262Z",
  },
};
---

<section
  class="bg-[url('/src/assets/images/contact-us.bg.png')] bg-cover bg-center pt-[var(--_typography-size---gap--page-top-gap)] pb-[var(--_typography-size---gap--section-gap)]"
>
  <Container>
    <div
      class="grid gap-[60px] min-[992px]:grid-cols-[1.5fr_1fr] min-[1280px]:gap-[80px] min-[1440px]:gap-[172px] max-[991px]:gap-x-[16px] max-[991px]:gap-y-[40px]"
    >
      <div class="flex flex-col">
        <div>
          <div
            class="inline-flex text-[20px] font-medium leading-[1.1] text-gradient"
            data-contact-animate
            data-contact-delay="0.05"
          >
            {hero.subtitle}
          </div>
          <div
            class="page-title-block margin-top-24px"
            data-contact-animate
            data-contact-delay="0.1"
          >
            <h1 class="page-title">{hero.title}</h1>
          </div>
          <div
            class="mt-[var(--_typography-size---gap--subtitle-gap)] max-w-[360px]"
            data-contact-animate
            data-contact-delay="0.15"
          >
            <p
              class="text-[20px] leading-[1.5] text-[#c4c4c4] max-[767px]:text-[18px]"
            >
              {hero.summary}
            </p>
          </div>
        </div>
        <div
          class="mt-[30px] flex flex-wrap items-center gap-[15px] min-[992px]:mt-[40px]"
          data-contact-animate
          data-contact-delay="0.2"
        >
          {
            socials.map(
              (social: {
                icon: keyof typeof socialIcons;
                href: string;
                label: string;
              }) => {
                const icon = socialIcons[social.icon];
                return (
                  <a
                    href={social.href}
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label={social.label}
                    class="flex h-10 w-10 items-center justify-center rounded-full border border-white/20 bg-[#0e1522] text-white transition hover:bg-[#d8ae6b] hover:text-[#0e1522]"
                  >
                    <svg
                      width={icon.width}
                      height={icon.height}
                      viewBox={icon.viewBox}
                      fill="none"
                      aria-hidden="true"
                    >
                      <path d={icon.path} fill="currentColor" />
                    </svg>
                  </a>
                );
              },
            )
          }
        </div>
      </div>
      <div
        class="flex flex-col gap-[80px] min-[1440px]:gap-[232px] max-[991px]:gap-[40px] min-[992px]:flex-row"
      >
        {
          infoColumns.map((column: any[]) => (
            <div
              class="flex flex-col gap-4"
              data-contact-animate
              data-contact-delay="0.25"
            >
              {column.map(
                (block: {
                  title: string;
                  maxWidth?: string;
                  items: { label: string; href?: string }[];
                }) => (
                  <div class="flex flex-col gap-4">
                    <div class="text-[16px] leading-[1.5] text-[#c4c4c4]">
                      {block.title}
                    </div>
                    <div
                      class="mt-[14px] flex flex-col gap-[5px]"
                      style={
                        block.maxWidth
                          ? `max-width: ${block.maxWidth};`
                          : undefined
                      }
                    >
                      {block.items.map((item) =>
                        item.href ? (
                          <a
                            href={item.href}
                            class="font-title text-[20px] font-medium leading-[1.4] text-white transition hover:text-[#d8ae6b]"
                          >
                            {item.label}
                          </a>
                        ) : (
                          <div class="font-title text-[20px] font-medium leading-[1.4] text-white">
                            {item.label}
                          </div>
                        ),
                      )}
                    </div>
                  </div>
                ),
              )}
            </div>
          ))
        }
      </div>
    </div>

    <div
      class="mt-10 min-[992px]:mt-[60px]"
      data-contact-animate
      data-contact-delay="0.35"
    >
      <video
        class="w-full rounded-[var(--_typography-size---gap--border-radius)] border border-white/20 object-cover min-h-[240px] sm:min-h-[320px] md:min-h-[400px] lg:min-h-[538px] max-h-[538px]"
        autoplay
        muted
        loop
        playsinline
        poster={video.poster}
      >
        <source src={video.mp4} type="video/mp4" />
        <source src={video.webm} type="video/webm" />
      </video>
    </div>

    <div class="mt-[80px] min-[992px]:mt-[100px]">
      <div class="text-center" data-contact-animate data-contact-delay="0.45">
        <h2
          class="font-title text-[length:var(--_typography-size---typography--h3)] font-normal leading-[1.3] tracking-[-0.01em] text-white"
        >
          {form.title}
        </h2>
        <div
          class="mx-auto mt-[var(--_typography-size---gap--subtitle-gap)] max-w-[456px]"
        >
          <p class="text-[18px] text-[#c4c4c4]">{form.summary}</p>
        </div>
      </div>
      <form
        class="mx-auto mt-[var(--_typography-size---gap--content-gap)] flex max-w-[968px] flex-col gap-[35px] min-[992px]:gap-[48px]"
        method="get"
        data-contact-animate
        data-contact-delay="0.55"
      >
        <div
          class="grid w-full grid-cols-1 gap-[40px] min-[992px]:grid-cols-2 min-[992px]:gap-[48px]"
        >
          <FormInput
            class="placeholder:text-white"
            type="text"
            name="name"
            id="name"
            placeholder="Name"
            required
          />
          <FormInput
            class="placeholder:text-white"
            type="email"
            name="email"
            id="email"
            placeholder="Email address "
            required
          />
        </div>
        <div
          class="grid w-full grid-cols-1 gap-[40px] min-[992px]:grid-cols-2 min-[992px]:gap-[48px]"
        >
          <FormInput
            class="placeholder:text-white"
            type="tel"
            name="phone"
            id="phone"
            placeholder="Phone number"
            required
          />
          <FormInput
            class="placeholder:text-white"
            type="text"
            name="subject"
            id="subject"
            placeholder="Subject"
            required
          />
        </div>
        <FormTextarea
          class="placeholder:text-white"
          name="message"
          id="message"
          placeholder="Message"
          required
        />
        <div class="submit-button-wrap mt-[40px] min-[992px]:mt-[50px]">
          <input type="submit" class="submit-button" value={form.submitLabel} />
        </div>
      </form>
    </div>

    <div
      class="mt-[var(--_typography-size---gap--section-gap)]"
      data-contact-animate
      data-contact-delay="0.65"
    >
      <div class="overflow-hidden rounded-[24px] bg-[#d9d9d9]">
        <iframe
          title="Contact map"
          class="h-[470px] w-full"
          src={`https://www.google.com/maps?q=${map.lat},${map.lng}&z=${map.zoom}&output=embed`}
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>
    </div>
  </Container>
</section>

<style>
  [data-contact-animate] {
    opacity: 0;
    transform: translateY(28px);
    filter: blur(14px);
    transition:
      opacity 0.7s ease,
      transform 0.7s ease,
      filter 0.7s ease;
  }

  [data-contact-animate].animate-in {
    opacity: 1;
    transform: translateY(0);
    filter: blur(0);
  }
</style>

<script>
  const initContactAnimation = () => {
    const animatedElements = document.querySelectorAll(
      "[data-contact-animate]",
    );

    if (!animatedElements.length) return;

    const prefersReducedMotion = window.matchMedia(
      "(prefers-reduced-motion: reduce)",
    ).matches;

    if (prefersReducedMotion) {
      animatedElements.forEach((element) => {
        element.classList.add("animate-in");
      });
      return;
    }

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (!entry.isIntersecting) return;
          const el = entry.target as HTMLElement;
          const delay = parseFloat(el.dataset.contactDelay || "0");

          setTimeout(() => {
            el.classList.add("animate-in");
          }, delay * 1000);

          observer.unobserve(el);
        });
      },
      {
        threshold: 0.2,
        rootMargin: "0px 0px -60px 0px",
      },
    );

    animatedElements.forEach((el) => observer.observe(el));
  };

  document.addEventListener("DOMContentLoaded", initContactAnimation);
  document.addEventListener("astro:page-load", initContactAnimation);
</script>

