---
import FormInput from "../ui/FormInput.astro";
import AppImage from "../ui/AppImage.astro";
---

<section
  class="relative flex h-screen w-screen max-h-full max-w-full items-center justify-center overflow-hidden bg-[url('/src/assets/images/404.png')] bg-cover bg-center max-[767px]:px-[15px]"
>
  <div class="absolute inset-0 z-[1] flex items-start justify-center">
    <AppImage
      src="/images/404-single-bg-image.png"
      alt=""
      width="1631"
      height="1000"
      loading="eager"
      fetchpriority="high"
      class="w-full max-w-[1631px]"
      data-password-shape-animate
      aria-hidden="true"
    />
  </div>

  <div
    class="relative z-10 flex w-full max-w-[528px] flex-col items-center text-center"
  >
    <form
      action="/.wf_auth"
      method="post"
      class="flex w-full flex-col items-center"
    >
      <div class="w-full">
        <div class="w-full">
          <AppImage
            src="/images/401-image.png"
            alt="Shield icon representing account protection"
            width="400"
            height="400"
            loading="eager"
            fetchpriority="high"
            class="mx-auto w-[400px] max-w-full max-[991px]:w-[350px] max-[479px]:w-[180px]"
          />
        </div>
      </div>
      <div class="mt-[30px] min-[1440px]:mt-[40px]">
        <h2
          class="section-title font-title text-[length:var(--_typography-size---typography--h2)] font-normal leading-[1.2] tracking-[-0.02em] text-white"
        >
          Protected Page
        </h2>
      </div>
      <div
        class="mt-[var(--_typography-size---gap--subtitle-gap)] max-w-[528px]"
      >
        <label
          for="pass"
          class="text-[20px] font-normal leading-[1.6] text-[#c4c4c4] max-[767px]:text-[18px]"
        >
          A password-protected page is a webpage on website requires users to
          enter a new specific password.
        </label>
      </div>
      <div class="mt-[20px] w-full max-w-[528px] min-[1440px]:mt-[24px]">
        <FormInput
          class="placeholder:text-white"
          autofocus
          maxlength={256}
          name="pass"
          placeholder="Enter your password"
          type="password"
          id="pass"
        />
      </div>
      <div
        class="mt-[40px] flex w-full justify-center min-[1440px]:mt-[50px] max-[767px]:mt-[30px]"
      >
        <input type="submit" value="Submit" class="submit-button border-0" />
      </div>
      <div
        class="w-password-page w-form-fail mt-4 hidden w-full text-center text-[#c4c4c4]"
      >
        <div>Incorrect password. Please try again.</div>
      </div>
    </form>
  </div>
</section>

<style>
  [data-password-shape-animate] {
    opacity: 0;
    transform: translate3d(100%, -100%, 0);
    transition:
      opacity 0.8s ease,
      transform 0.9s ease;
  }

  [data-password-shape-animate].animate-in {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
</style>

<script is:inline>
  const initPasswordShapeAnimation = () => {
    const shape = document.querySelector("[data-password-shape-animate]");
    if (!shape) return;

    const prefersReducedMotion = window.matchMedia(
      "(prefers-reduced-motion: reduce)",
    ).matches;

    if (prefersReducedMotion) {
      shape.classList.add("animate-in");
      return;
    }

    requestAnimationFrame(() => {
      shape.classList.add("animate-in");
    });
  };

  document.addEventListener("DOMContentLoaded", initPasswordShapeAnimation);
  document.addEventListener("astro:page-load", initPasswordShapeAnimation);

  (() => {
    if (/[?&]e=1(&|$)/.test(window.location.search)) {
      const errorBlock = document.querySelector(".w-password-page.w-form-fail");
      if (errorBlock) {
        errorBlock.classList.remove("hidden");
      }
    }
  })();
</script>

